---
title: 3. ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ê³¼ ìë™ ì˜ì¡´ê´€ê³„ ì„¤ì •
date: 2023-10-06 19:00:00 +09:00
categories: [Spring, Spring ì…ë¬¸]
tags: [Spring]
---

# AOP

## ğŸ“ŒAOPê°€ ì—†ëŠ” ê²½ìš°

- ë§Œì•½ ëª¨ë“  ë©”ì„œë“œì˜ í˜¸ì¶œ ì‹œê°„ì„ ì¸¡ì •í•˜ê³  ì‹¶ë‹¤ê³  í•œë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ ëª¨ë“  ë©”ì„œë“œì— ì‹œê°„ ì¸¡ì • ë¡œì§ì„ ì‘ì„±í•´ì£¼ì–´ì•¼ í•œë‹¤.

```java
package hello.hellospring.service;
import hello.hellospring.domain.Member;
import hello.hellospring.repository.MemberRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import javax.transaction.Transactional;
import java.util.List;
import java.util.Optional;

@Transactional
public class MemberService {

    private final MemberRepository memberRepository;

    @Autowired
    public MemberService(MemberRepository memberRepository){
        this.memberRepository = memberRepository;
    }

    /**
     * íšŒì›ê°€ì…
     */
    public Long join(Member member){
        long start = System.currentTimeMillis();

        try{
            // ê°™ì€ ì´ë¦„ì´ ìˆëŠ” ì¤‘ë³µ íšŒì›x
            validateDuplicateMember(member);
            memberRepository.save(member);
            return member.getId();
        }finally {
            long finish = System.currentTimeMillis();
            long timeMs = finish - start;
            System.out.println("join = " + timeMs + "ms");
        }



    }

    private void validateDuplicateMember(Member member){
        memberRepository.findByName(member.getName()).ifPresent(m -> {
            throw new IllegalStateException("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì…ë‹ˆë‹¤.");
        });
    }

    /**
     * ì „ì²´ íšŒì› ì¡°íšŒ
     */
    public List<Member> findMembers(){
        long start = System.currentTimeMillis();

        try{
            return memberRepository.findAll();
        }finally {
            long finish = System.currentTimeMillis();
            long timeMs = finish - start;
            System.out.println("join = " + timeMs + "ms");
        }

    }

    public Optional<Member> findOne(Long memberId){
        return memberRepository.findById(memberId);
    }
}

```

ìœ„ì™€ ê°™ì´ ë¡œì§ì„ ì‘ì„±í•˜ë©´ ë°œìƒë˜ëŠ” ë¬¸ì œë“¤ì´ ìˆë‹¤.

- íšŒì›ê°€ì…, íšŒì› ì¡°íšŒì— ì‹œê°„ì„ ì¸¡ì •í•˜ëŠ” ê¸°ëŠ¥ì€ í•µì‹¬ ê´€ì‹¬ ì‚¬í•­ì´ ì•„ë‹ˆë‹¤.
- ì‹œê°„ì„ ì¸¡ì •í•˜ëŠ” ë¡œì§ì€ ê³µí†µ ê´€ì‹¬ ì‚¬í•­ì´ë‹¤.
- ì‹œê°„ì„ ì¸¡ì •í•˜ëŠ” ë¡œì§ê³¼ í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ì˜ ë¡œì§ì´ ì„ì—¬ì„œ ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë µë‹¤.
- ì‹œê°„ì„ ì¸¡ì •í•˜ëŠ” ë¡œì§ì„ ë³„ë„ì˜ ê³µí†µ ë¡œì§ìœ¼ë¡œ ë§Œë“¤ê¸° ë§¤ìš° ì–´ë µë‹¤.
- ì‹œê°„ì„ ì¸¡ì •í•˜ëŠ” ë¡œì§ì„ ë³€ê²½í•  ë•Œ ëª¨ë“  ë¡œì§ì„ ì°¾ì•„ê°€ë©´ì„œ ë³€ê²½í•´ì•¼ í•œë‹¤.

<br/>

## ğŸ“Œ AOP ì ìš©

- AOP: Aspect Oriented Programming
- ê³µí†µ ê´€ì‹¬ ì‚¬í•­(cross-cutting concern)ê³¼ í•µì‹¬ ê´€ì‹¬ ì‚¬í•­(core concern) ë¶„ë¦¬í•˜ëŠ” ê²ƒì´ í•µì‹¬ì´ë‹¤.
  <img src="https://private-user-images.githubusercontent.com/140701897/273177800-d282b419-ed8e-4c0c-a36d-f2a166ed5f9f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTEiLCJleHAiOjE2OTY1ODc2OTEsIm5iZiI6MTY5NjU4NzM5MSwicGF0aCI6Ii8xNDA3MDE4OTcvMjczMTc3ODAwLWQyODJiNDE5LWVkOGUtNGMwYy1hMzZkLWYyYTE2NmVkNWY5Zi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBSVdOSllBWDRDU1ZFSDUzQSUyRjIwMjMxMDA2JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDIzMTAwNlQxMDE2MzFaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT05MDJlZTczY2ExMTA2ZGE1MzA2OGUzYWExYmQ0ZTAyNzdiNjRhMTc1NWIyMjY2N2ZiNzc0MzY2YWIyYjAzMjY2JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.tJnHNbrH4n1HICoXHpnd4CrQTJiALZaSkNiRg-zXJZ0">

  - aop ë§Œë“¤ì–´ë³´ê¸°

```java
package hello.hellospring.aop;

import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.springframework.stereotype.Component;

@Aspect
@Component
public class TimeTraceAop {

    @Around("execution(* hello.hellospring..*(..))")
    public Object execute(ProceedingJoinPoint joinPoint) throws Throwable{
        long start = System.currentTimeMillis();
        System.out.println("start : " + joinPoint.toString());
        try {
            return joinPoint.proceed();
        }finally {
            long finish = System.currentTimeMillis();
            long timeMs = finish - start;
            System.out.println("END: " + joinPoint.toString() + " " +  timeMs + "ms");
        }
    }
}
```

ì´ë ‡ê²Œ ì„¤ì •í•˜ê³  ì„œë²„ë¥¼ ì‹¤í–‰í•˜ì—¬ ë©”ì„œë“œë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´ ì•„ë˜ ì‚¬ì§„ê³¼ ê°™ì´ ê° ë©”ì„œë“œì˜ ì‹¤í–‰ì‹œê°„ì„ ì•Œ ìˆ˜ ìˆë‹¤.

<img src="https://private-user-images.githubusercontent.com/140701897/273183364-322062a8-925a-435e-82ec-24898d88e4c9.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTEiLCJleHAiOjE2OTY1ODg4OTksIm5iZiI6MTY5NjU4ODU5OSwicGF0aCI6Ii8xNDA3MDE4OTcvMjczMTgzMzY0LTMyMjA2MmE4LTkyNWEtNDM1ZS04MmVjLTI0ODk4ZDg4ZTRjOS5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBSVdOSllBWDRDU1ZFSDUzQSUyRjIwMjMxMDA2JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDIzMTAwNlQxMDM2MzlaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1kMmQ2MWZhZWI2YjEyZjk3YmYxNTdlY2U4ZTdhZmUxNDk1ZGY0MjA2MWQ0YTc1OTJmMmE0MTBhNWY2ZGY5Mjg1JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.YkPvUrfCbQlmRwK69wyWzgU_wdr11ng214-OAZAQiO4">

<br/>

ì´ë ‡ê²Œ AOPë¡œ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

- íšŒì›ê°€ì…, íšŒì› ì¡°íšŒë“± í•µì‹¬ ê´€ì‹¬ì‚¬í•­ê³¼ ì‹œê°„ì„ ì¸¡ì •í•˜ëŠ” ê³µí†µ ê´€ì‹¬ ì‚¬í•­ì„ ë¶„ë¦¬í•œë‹¤.
- ì‹œê°„ì„ ì¸¡ì •í•˜ëŠ” ë¡œì§ì„ ë³„ë„ì˜ ê³µí†µ ë¡œì§ìœ¼ë¡œ ë§Œë“¤ì—ˆë‹¤.
- í•µì‹¬ ê´€ì‹¬ ì‚¬í•­ì„ ê¹”ë”í•˜ê²Œ ìœ ì§€í•  ìˆ˜ ìˆë‹¤.
- ë³€ê²½ì´ í•„ìš”í•˜ë©´ ì´ ë¡œì§ë§Œ ë³€ê²½í•˜ë©´ ëœë‹¤.
- ì›í•˜ëŠ” ì ìš© ëŒ€ìƒì„ ì„ íƒí•  ìˆ˜ ìˆë‹¤.

## ğŸ“Œ AOPì˜ ë™ì‘
